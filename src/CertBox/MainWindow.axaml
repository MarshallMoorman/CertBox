<!-- src/CertBox/MainWindow.axaml -->
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:CertBox.ViewModels"
        xmlns:converters="using:CertBox.Converters"
        x:Class="CertBox.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="CertBox"
        Width="800"
        Height="600"
        Background="#000000">
    <Window.Resources>
        <converters:ExpiredColorConverter x:Key="ExpiredColorConverter" />
    </Window.Resources>
    <Grid RowDefinitions="Auto,Auto,Auto,*" Margin="10">
        <!-- File Picker Button and Path -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
            <Button Content="Open cacerts File"
                    Command="{Binding OpenFilePickerCommand}"
                    Background="#FFFFFF"
                    Foreground="#000000"
                    BorderBrush="#E0E0E0" />
            <TextBlock Text="{Binding SelectedFilePath, StringFormat='Selected File: {0}'}"
                       Foreground="#FFFFFF"
                       VerticalAlignment="Center"
                       Margin="10,0,0,0" />
        </StackPanel>

        <!-- Search Bar -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
            <TextBox Watermark="Search certificates..."
                     Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                     Width="300"
                     Background="#000000"
                     Foreground="#FFFFFF"
                     BorderBrush="#E0E0E0"
                     BorderThickness="1" />
            <Button Content="Import"
                    Command="{Binding ImportCommand}"
                    Background="#FFFFFF"
                    Foreground="#000000"
                    BorderBrush="#E0E0E0"
                    IsEnabled="{Binding CanImport}" />
            <Button Content="Remove"
                    Command="{Binding RemoveCommand}"
                    Background="#FFFFFF"
                    Foreground="#000000"
                    BorderBrush="#E0E0E0"
                    IsEnabled="{Binding CanRemove}" />
        </StackPanel>

        <!-- Certificate Table -->
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Certificates}"
                  SelectedItem="{Binding SelectedCertificate, Mode=TwoWay}"
                  SelectionMode="Single"
                  AutoGenerateColumns="False"
                  Background="#000000"
                  BorderBrush="#E0E0E0"
                  BorderThickness="1"
                  HeadersVisibility="All">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Alias"
                                    Binding="{Binding Alias}"
                                    IsReadOnly="True"
                                    Foreground="#FFFFFF" />
                <DataGridTextColumn Header="Issuer"
                                    Binding="{Binding Issuer}"
                                    IsReadOnly="True"
                                    Foreground="#FFFFFF" />
                <DataGridTextColumn Header="Subject"
                                    Binding="{Binding Subject}"
                                    IsReadOnly="True"
                                    Foreground="#FFFFFF" />
                <DataGridTemplateColumn Header="Expiry"
                                        IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding ExpiryDate}"
                                       Foreground="{Binding IsExpired, Converter={StaticResource ExpiredColorConverter}}"
                                       VerticalAlignment="Center" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window>